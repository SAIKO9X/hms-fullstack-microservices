<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <style>
        body { font-family: 'Arial', sans-serif; color: #444; margin: 0; padding: 40px; }
        .invoice-box { max-width: 800px; margin: auto; }
        .header-table { width: 100%; margin-bottom: 40px; }
        .title { font-size: 32px; color: #3b82f6; font-weight: bold; }
        .status-badge { padding: 5px 10px; border-radius: 4px; font-size: 12px; font-weight: bold; text-transform: uppercase; }
        .status-paid { background: #dcfce7; color: #166534; }
        .status-pending { background: #fef9c3; color: #854d0e; }

        .details-grid { width: 100%; margin-bottom: 30px; }
        .details-grid td { vertical-align: top; width: 50%; padding: 10px; }

        .items-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .items-table th { background: #3b82f6; color: white; padding: 12px; text-align: left; }
        .items-table td { padding: 12px; border-bottom: 1px solid #e5e7eb; }

        .totals-table { width: 300px; margin-left: auto; margin-top: 30px; }
        .totals-table td { padding: 8px; text-align: right; }
        .grand-total { font-size: 18px; font-weight: bold; color: #1e40af; border-top: 2px solid #3b82f6; }
    </style>
</head>
<body>
<div class="invoice-box">
    <table class="header-table">
        <tr>
            <td class="title">FATURA</td>
            <td style="text-align: right;">
                <strong>HMS Billing Service</strong><br/>
                ID: #<span th:text="${invoiceId}">999</span><br/>
                Emissão: <span th:text="${#temporals.format(issuedAt, 'dd/MM/yyyy HH:mm')}">28/01/2026</span><br/>
                <span th:if="${isPaid}" class="status-badge status-paid">PAGO</span>
                <span th:if="${isPending}" class="status-badge status-pending">PENDENTE</span>
            </td>
        </tr>
    </table>

    <table class="details-grid">
        <tr>
            <td>
                <strong>Faturado para:</strong><br/>
                <span th:text="${patientInfo}">Nome do Paciente (CPF: 000.000.000-00)</span><br/>
                <span th:if="${hasInsurance}">
                    <strong>Convênio:</strong> <span th:text="${insuranceName}">Unimed</span>
                </span>
                <span th:unless="${hasInsurance}">
                    <strong>Modalidade:</strong> Particular
                </span>
            </td>
            <td>
                <strong>Serviço Prestado:</strong><br/>
                Consulta Médica<br/>
                <span th:text="${doctorInfo}">Dr. Nome - Especialidade (CRM: 00000-XX)</span>
            </td>
        </tr>
    </table>

    <table class="items-table">
        <thead>
        <tr>
            <th>Descrição</th>
            <th style="text-align: right;">Valor</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>Honorários de Consulta Médica</td>
            <td style="text-align: right;" th:text="${'R$ ' + #numbers.formatDecimal(totalAmount, 1, 2, 'POINT')}">R$
                200,00
            </td>
        </tr>
        </tbody>
    </table>

    <table class="totals-table">
        <tr>
            <td>Subtotal:</td>
            <td th:text="${'R$ ' + #numbers.formatDecimal(totalAmount, 1, 2, 'POINT')}">R$ 200,00</td>
        </tr>
        <tr th:if="${insuranceCovered > 0}">
            <td style="color: #166534;">Cobertura Convênio:</td>
            <td style="color: #166534;" th:text="${'- R$ ' + #numbers.formatDecimal(insuranceCovered, 1, 2, 'POINT')}">-
                R$ 160,00
            </td>
        </tr>
        <tr class="grand-total">
            <td>Total a Pagar (Paciente):</td>
            <td th:text="${'R$ ' + #numbers.formatDecimal(patientPayable, 1, 2, 'POINT')}">R$ 40,00</td>
        </tr>
    </table>

    <div style="margin-top: 50px; border-top: 1px dashed #ccc; padding-top: 20px; font-size: 11px; color: #999; text-align: center;">
        <p th:if="${isPaid}">✓ Esta fatura foi paga em <span
                th:text="${#temporals.format(paidAt, 'dd/MM/yyyy HH:mm')}"></span></p>
        <p>Documento gerado eletronicamente pelo HMS - Hospital Management System</p>
    </div>
</div>
</body>
</html>